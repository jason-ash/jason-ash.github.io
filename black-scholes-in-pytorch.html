<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	<title>Jason Ash | Thought Archive</title>
	<meta name="description" content="Writing about probability & Bayesian inference, data visualization, puzzles & games, finance, and books">	
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="theme/css/main.css">

	<!-- favicon -->
	<link href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAHwAAABcAAAAjAAAANAAAABQAAAAJAAAAAAAAAAAAAACxAAAA7QAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAKwAAADdAAAA7wAAAPcAAADuAAAAxwAAAJcAAAA7AAAA/wAAAP4AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAEgAAADPAAAA/gAAAP8AAAD/AAAA/gAAAP8AAAD/AAAA/AAAAP8AAAD/AAAAwgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAAPkAAAD9AAAA/wAAAP8AAAD+AAAA/wAAAP8AAAD/AAAA4AAAAEYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAAAQAAAAFgAAACMAAAA+AAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAMgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAGQAAAMUAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAJsAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADMAAAAswAAAHsAAAD/AAAA/wAAAP8AAAD+AAAAaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeAAAAAAAAAAAAAAAgwAAAP8AAAD+AAAA/gAAAN8AAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAADAAAAA/wAAAP8AAAD/AAAAVwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGQAAALMAAAD/AAAA/wAAAKIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAATgAAAI4AAABOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAP//AAD//wAA/48AAICPAACADwAAwB8AAPgPAAD8BwAA/IcAAP+DAAD/wwAA/+EAAP/7AAD//wAA//8AAA==" rel="icon" type="image/x-icon" />
	
	<!-- Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-122705782-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());
	  gtag('config', 'UA-122705782-1');
	</script>

  </head>
  <body>
    
<nav class="navbar navbar-expand-sm navbar-light bg-white sticky-top">
  
  <div class="container">
  <a class="navbar-brand" href="/index">Jason Ash</a>
  
  <button class="navbar-toggler mt-1" type="button" data-toggle="collapse" data-target="#navbarNav">
        <i class="fa fa-bars"></i>
    </button>
  

  

  <div class="collapse navbar-collapse" id="navbarNav"> 
    <ul class="navbar-nav ml-auto">
      <li class="nav-item mr-4">
        <a class="nav-link" href="/index">Writing</a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="/resume" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Resume
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          <a class="dropdown-item" href="/resume">View</a>
          <a class="dropdown-item" href="/resume.pdf" target="_blank">Download</a>
        </div>
      </li>
    </ul>
  </div>  
  </div>
  
</nav>    
    <div class="container" style="min-height:88vh">
<div class="row justify-content-center">
  <div class="col-md-8">
  
    <div class="row mt-5">
      <div class="col">
        <div class="d-flex justify-content-between align-items-baseline mb-4">
          <h1>Black-Scholes in PyTorch</h1>
          <label class="text-muted">Dec 9, 2018</label>
        </div>
        <div class="mb-5">
          <p><p>I've been experimenting with several machine learning frameworks lately, including <a href="https://www.tensorflow.org/" target="_blank">Tensorflow</a>, <a href="https://pytorch.org/" target="_blank">PyTorch</a>, and <a href="https://chainer.org/" target="_blank">Chainer</a>. I'm fascinated by the concept of automatic differentiation. It's incredible to me that these libraries can calculate potentially millions of partial derivatives of virtually any function with only one extra pass through the code. </p>
<p>Automatic differentiation is critical for deep learning models, but I wanted to see how it could be applied elsewhere. I've always been interested in financial derivatives like stock options, and calculating greeks (the partial derivatives of option price) can often be a slow process of running and re-running models repeatedly. The process gets even more complicated for complex, path-dependent options. As I found while writing this article, PyTorch can make this process much faster and more exact.</p>
<h5>Goals for this article</h5>
<p>The purpose of this article is to use PyTorch to implement four methods of calculating European put option price and greeks. I'll demonstrate how automatic differentiation can be used to calculate option greeks, and measure the time it takes for each implementation. </p>
<ol>
<li>Use the Black-Scholes formula and the closed-form equations for option greeks.</li>
<li>Use the Black-Scholes formula and calculate option greeks using the "finite difference" method.</li>
<li>Use the Black-Scholes formulas for option value and use PyTorch to automatically differentiate the output and calculate the option greeks.</li>
<li>Use a monte carlo simulation of option values in PyTorch. Then use automatic differentiation to calculate option greeks.</li>
</ol>
<h5>A brief primer on European stock options:</h5>
<p>A European stock option is a financial instrument that gives the owner the right, but not the obligation, to buy or sell an underlying security for a pre-determined price at a specific future date. It goes without saying that the future values of financial securities are uncertain. Therefore, options on those securities can be difficult to price. </p>
<p>There are plenty of resources available to learn about options, from the basics all the way through stochastic calculus and exotic option varieties. In fact, many of the techniques that I'm going to demonstrate become much more relevant and powerful for more complex options. However, for the purposes of this article I'm going to focus exclusively on a simple European put option. Fortunately, if we make certain simplifying assumptions, the European put option can be valued in closed-form using the famous Black-Scholes formula.</p>
<p>In addition to knowing the value of the option, it is also useful to understand how the value will change if certain assumptions change. In other words, it is useful to understand the partial derivatives of option value with respect to the inputs to the Black-Scholes formula. These sensitivities are typically called "the greeks". We'll use closed-form equations as well as PyTorch's automatic differentation to calculate the greeks.</p>
<h5>The Black-Scholes Formula</h5>
<p>This is the formula we'll use to calculate the price of the European put option. There are formulas for each of the greeks too: delta, rho, vega, theta, epsilon, etc., but I'll spare the math for now. </p>
<p>$$
P = Ke^{-\mu t} \phi(-d_2) - Se^{-\delta t} \phi(-d_1)\\\
d_1 = \frac{\ln({\frac{S}{K})} + (\mu -\delta + \frac{\sigma^2}{2})t}{\sigma\sqrt{t}}\\\
d_2 = \frac{\ln({\frac{S}{K})} + (\mu -\delta - \frac{\sigma^2}{2})t}{\sigma\sqrt{t}}
$$ </p>
<p>where </p>
<ul>
<li>$P$ is the put option price</li>
<li>$S$ is the stock price</li>
<li>$K$ is the strike (exercise) price</li>
<li>$\mu$ is the annual continuously compounded risk free interest rate</li>
<li>$\sigma$ is the annual volatility of the underlying security</li>
<li>$t$ is the time to expiry in years</li>
<li>$\delta$ is the annual continous dividend rate</li>
<li>$\phi(x)$ is the standard normal CDF evaluated at $x$</li>
</ul>
<h5>PyTorch setup</h5>
<p>Like many deep learning frameworks available today, PyTorch provides high-performance numerical computation, automatic differentiation, and the ability to run on distributed grids of hardware accelerators, like GPUs. PyTorch computational graphs are created on the fly, as opposed to the static graphs you build in a language like Tensorflow. But both libraries provide automatic differentiation out of the box.</p>
<p>To enable automatic differentiation, we must identify the inputs to our formulas as tensors and start gradient tracking for those inputs. PyTorch will keep track of the operations on those inputs from the beginning to the end. Once we're finished with our computation and we have our output, we can run reverse mode automatic differentiation to calculate the gradient of the output with respect to each input.</p>
<p>Throughout this article, I'll use the following six input tensors and their defined values for the Black-Scholes formula. I'll also create two utility functions that we'll use as we go along.</p>
<div class="highlight"><pre><span></span><span class="c1"># black-scholes inputs</span>
<span class="n">stock</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">strike</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.035</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">vol</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.16</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">dividend</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># utility functions</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
</pre></div>


<h5>Method 1: Black-Scholes Formula for Option Value and Greeks</h5>
<p>The first method is purely formulaic. We'll use the Black-Scholes formula plus the formulas for all option greeks. PyTorch is certainly overkill for this method - we could use virtually any programming language to implement this.</p>
<div class="highlight"><pre><span></span><span class="c1"># black-scholes formula</span>
<span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">stock</span><span class="o">/</span><span class="n">strike</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rate</span> <span class="o">-</span> <span class="n">dividend</span> <span class="o">+</span> <span class="n">vol</span><span class="o">*</span><span class="n">vol</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">vol</span><span class="o">*</span><span class="n">time</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">stock</span><span class="o">/</span><span class="n">strike</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rate</span> <span class="o">-</span> <span class="n">dividend</span> <span class="o">-</span> <span class="n">vol</span><span class="o">*</span><span class="n">vol</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">vol</span><span class="o">*</span><span class="n">time</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ov</span> <span class="o">=</span> <span class="n">strike</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rate</span><span class="o">*</span><span class="n">time</span><span class="p">)</span><span class="o">*</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span> <span class="o">-</span> <span class="n">stock</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dividend</span><span class="o">*</span><span class="n">time</span><span class="p">)</span><span class="o">*</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>

<span class="c1"># black-scholes greeks</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dividend</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cdf</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="o">-</span><span class="n">strike</span> <span class="o">*</span> <span class="n">time</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rate</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span>
<span class="n">vega</span> <span class="o">=</span> <span class="n">stock</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dividend</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="o">*</span> <span class="n">time</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span>
    <span class="n">rate</span> <span class="o">*</span> <span class="n">strike</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rate</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span>
    <span class="o">-</span> <span class="n">stock</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dividend</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="o">*</span> <span class="n">vol</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">time</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> 
    <span class="o">-</span> <span class="n">dividend</span> <span class="o">*</span> <span class="n">stock</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dividend</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">stock</span> <span class="o">*</span> <span class="n">time</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dividend</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>
<span class="n">strike_greek</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rate</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span>
</pre></div>


<p>When we run this code with our inputs from above, we get the following table of outputs. This option price is <span>$</span>5.09. Plus, we can estimate how the price will change if any of our model inputs changes. For example, a Delta of -0.4026 implies that if the underlying security increases in value by <span>$</span>1 (from <span>$</span>100 to <span>$</span>101), the option price should decrease by roughly <span>$</span>0.40. Similarly, if we were to decrease the time-to-expiry of this option from 1.0 years to 0.9 years, we would expect option price to decrease by roughly 10% of the option theta, or 0.18883.</p>
<div class="highlight"><pre><span></span><span class="n">Option</span> <span class="n">Value</span><span class="p">:</span>     <span class="mf">5.0885</span>   <span class="c1"># sensitivity of option price to:</span>
<span class="o">------------------------</span>   <span class="o">---------------------------------</span>
       <span class="n">Delta</span><span class="p">:</span>    <span class="o">-</span><span class="mf">0.4026</span>   <span class="c1"># underlying price</span>
         <span class="n">Rho</span><span class="p">:</span>   <span class="o">-</span><span class="mf">45.3458</span>   <span class="c1"># interest rates</span>
        <span class="n">Vega</span><span class="p">:</span>    <span class="mf">38.4103</span>   <span class="c1"># volatility</span>
       <span class="n">Theta</span><span class="p">:</span>     <span class="mf">1.8883</span>   <span class="c1"># time</span>
     <span class="n">Epsilon</span><span class="p">:</span>    <span class="mf">40.2573</span>   <span class="c1"># dividend rate</span>
 <span class="n">Strike</span> <span class="n">Sens</span><span class="p">:</span>     <span class="mf">0.4535</span>   <span class="c1"># strike price</span>
</pre></div>


<h5>Method 2: Black-Scholes Formula with Finite Difference Greeks</h5>
<p>With most models, a simple way of calculating partial derivatives is to re-run the model many times with slightly different inputs and observe how the output changes with each new run. This is often called the "finite difference" or "bump-and-revalue" method. It doesn't require you to derive the greeks of the formula by hand - indeed this can often be impossible. This method provides an estimate of the true partial derivative, and is based on the following formula:</p>
<p>$$
f\prime(x) \approx \frac{f(x + \delta) - f(x)}{\delta}
$$</p>
<p>As an example, let's estimate put option delta using this method. We originally valued the option at <span>$</span>5.0885 (above), given a stock input of <span>$</span>100. If we re-run our model after changing stock to <span>$</span>101 and keeping everything else constant, the option price decreases to <span>$</span>4.6978. Then, according to the formula above, our estimate of delta is:</p>
<p>$$
f\prime(x) \approx \frac{5.0885 - 4.6978}{1} \approx -0.3907
$$</p>
<p>Let's implement this in code. Again, PyTorch is overkill here because we're simply using the same Black-Scholes formula from Method 1 and re-running it six extra times to calculate our option greeks. </p>
<div class="highlight"><pre><span></span><span class="c1"># black-scholes formula</span>
<span class="k">def</span> <span class="nf">bs</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">strike</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dividend</span><span class="p">):</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">stock</span><span class="o">/</span><span class="n">strike</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rate</span> <span class="o">-</span> <span class="n">dividend</span> <span class="o">+</span> <span class="n">vol</span><span class="o">*</span><span class="n">vol</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">vol</span><span class="o">*</span><span class="n">time</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">stock</span><span class="o">/</span><span class="n">strike</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rate</span> <span class="o">-</span> <span class="n">dividend</span> <span class="o">-</span> <span class="n">vol</span><span class="o">*</span><span class="n">vol</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">vol</span><span class="o">*</span><span class="n">time</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ov</span> <span class="o">=</span> <span class="n">strike</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rate</span><span class="o">*</span><span class="n">time</span><span class="p">)</span><span class="o">*</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span> <span class="o">-</span> <span class="n">stock</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dividend</span><span class="o">*</span><span class="n">time</span><span class="p">)</span><span class="o">*</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ov</span>

<span class="c1"># baseline option value and 1% sensitivities</span>
<span class="n">ov</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">strike</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dividend</span><span class="p">)</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="mf">1.01</span><span class="o">*</span><span class="n">stock</span><span class="p">,</span> <span class="n">strike</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dividend</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">strike</span><span class="p">,</span> <span class="mf">1.01</span><span class="o">*</span><span class="n">rate</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dividend</span><span class="p">)</span>
<span class="n">vega</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">strike</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="mf">1.01</span><span class="o">*</span><span class="n">vol</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dividend</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">strike</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="mf">1.01</span><span class="o">*</span><span class="n">time</span><span class="p">,</span> <span class="n">dividend</span><span class="p">)</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">strike</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="mf">1.01</span><span class="o">*</span><span class="n">dividend</span><span class="p">)</span>
<span class="n">strike_greek</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="mf">1.01</span><span class="o">*</span><span class="n">strike</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dividend</span><span class="p">)</span>

<span class="c1"># scaling; in each case, Î´ is 1% of the starting value</span>
<span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">delta</span> <span class="o">-</span> <span class="n">ov</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">stock</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span> <span class="o">-</span> <span class="n">ov</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">rate</span><span class="p">)</span>
<span class="n">vega</span> <span class="o">=</span> <span class="p">(</span><span class="n">vega</span> <span class="o">-</span> <span class="n">ov</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">vol</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">ov</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">time</span><span class="p">)</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="p">(</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">ov</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">dividend</span><span class="p">)</span>
<span class="n">strike_greek</span> <span class="o">=</span> <span class="p">(</span><span class="n">strike_greek</span> <span class="o">-</span> <span class="n">ov</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">strike</span><span class="p">)</span>
</pre></div>


<p>We see that the option greeks from this method vary slightly compared to the exact formulas used in Method 1. This is because we can only approximate the partial derivatives through finite difference. I used 1% sensitivities, which is fairly standard. Smaller values, like 0.1%, would result in greeks closer to the exact values, but wouldn't reflect as much convexity in the option price. That is typically the tradeoff with the finite differences method.</p>
<div class="highlight"><pre><span></span><span class="n">Option</span> <span class="n">Value</span><span class="p">:</span>     <span class="mf">5.0885</span>   <span class="c1"># sensitivity of option price to:</span>
<span class="o">------------------------</span>   <span class="o">---------------------------------</span>
       <span class="n">Delta</span><span class="p">:</span>    <span class="o">-</span><span class="mf">0.3907</span>   <span class="c1"># underlying price</span>
         <span class="n">Rho</span><span class="p">:</span>   <span class="o">-</span><span class="mf">45.2968</span>   <span class="c1"># interest rates</span>
        <span class="n">Vega</span><span class="p">:</span>    <span class="mf">38.4164</span>   <span class="c1"># volatility</span>
       <span class="n">Theta</span><span class="p">:</span>     <span class="mf">1.8803</span>   <span class="c1"># time</span>
     <span class="n">Epsilon</span><span class="p">:</span>    <span class="mf">40.2069</span>   <span class="c1"># dividend rate</span>
 <span class="n">Strike</span> <span class="n">Sens</span><span class="p">:</span>     <span class="mf">0.4654</span>   <span class="c1"># strike price</span>
</pre></div>


<h5>Method 3: Black-Scholes Formula with PyTorch Automatic Differentiation</h5>
<p>Now the fun part. Before, we either had to carefully program complex formulas for option greeks (missing a negative sign here or there is a common and frustrating error), or re-run our model several times and scale the outputs. It's easy to make mistakes in either case.</p>
<p>Instead, let's start to leverage PyTorch's automatic differentiation. As before, we program the Black-Scholes formula (you'll notice the implementation is exactly the same). Once we have the option value, we simply call <code>ov.backward()</code> to tell PyTorch that we want to calculate the partial derivatives of our model. Because we tagged each input with <code>require_grad=True</code>, we can call <code>.grad</code> on each input to get its gradient.</p>
<div class="highlight"><pre><span></span><span class="c1"># black-scholes formula</span>
<span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">stock</span><span class="o">/</span><span class="n">strike</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rate</span> <span class="o">-</span> <span class="n">dividend</span> <span class="o">+</span> <span class="n">vol</span><span class="o">*</span><span class="n">vol</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">vol</span><span class="o">*</span><span class="n">time</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">stock</span><span class="o">/</span><span class="n">strike</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rate</span> <span class="o">-</span> <span class="n">dividend</span> <span class="o">-</span> <span class="n">vol</span><span class="o">*</span><span class="n">vol</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">vol</span><span class="o">*</span><span class="n">time</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ov</span> <span class="o">=</span> <span class="n">strike</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rate</span><span class="o">*</span><span class="n">time</span><span class="p">)</span><span class="o">*</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span> <span class="o">-</span> <span class="n">stock</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dividend</span><span class="o">*</span><span class="n">time</span><span class="p">)</span><span class="o">*</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span>

<span class="c1"># run backpropagation to calculate option greeks</span>
<span class="n">ov</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">grad</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">grad</span>
<span class="n">vega</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">grad</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">grad</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">dividend</span><span class="o">.</span><span class="n">grad</span>
<span class="n">strike_greek</span> <span class="o">=</span> <span class="n">strike</span><span class="o">.</span><span class="n">grad</span>
</pre></div>


<p>Each value in the table below is identical to our original calculations using Method 1. And I would argue that the code above is significantly simpler to write, read, and debug. Furthermore, I can be confident that the gradients are correct because I didn't have to input complex formulas by hand.</p>
<div class="highlight"><pre><span></span><span class="n">Option</span> <span class="n">Value</span><span class="p">:</span>     <span class="mf">5.0885</span>   <span class="c1"># sensitivity of option price to:</span>
<span class="o">------------------------</span>   <span class="o">---------------------------------</span>
       <span class="n">Delta</span><span class="p">:</span>    <span class="o">-</span><span class="mf">0.4026</span>   <span class="c1"># underlying price</span>
         <span class="n">Rho</span><span class="p">:</span>   <span class="o">-</span><span class="mf">45.3458</span>   <span class="c1"># interest rates</span>
        <span class="n">Vega</span><span class="p">:</span>    <span class="mf">38.4103</span>   <span class="c1"># volatility</span>
       <span class="n">Theta</span><span class="p">:</span>     <span class="mf">1.8883</span>   <span class="c1"># time</span>
     <span class="n">Epsilon</span><span class="p">:</span>    <span class="mf">40.2573</span>   <span class="c1"># dividend rate</span>
 <span class="n">Strike</span> <span class="n">Sens</span><span class="p">:</span>     <span class="mf">0.4535</span>   <span class="c1"># strike price</span>
</pre></div>


<h5>Method 4: Monte Carlo simulation of stock prices with Automatic Differentiation</h5>
<p>The fourth method is unlike the first three in that it doesn't use the Black-Scholes formula at all. Instead, it uses the principle upon which the formula is based, called Geometric Brownian Motion (GBM). GBM is a model for simulating future distributions of stock returns. It is a stochastic method, which means we'll draw thousands of samples from a normal distribution of stock returns in order to understand the potential future values of the stock on the exercise date.</p>
<p>Once we have several thousand randomly drawn future stock values, we simply calculate the option payoff under each scenario. We then discount the future payoffs to today and take the average value of all the scenarios we ran. If we run enough scenarios, then the average should converge to the Black-Scholes price of the option.</p>
<p><img class="img-fluid mx-auto d-block" title="Monte Carlo" alt="monte carlo" src="../images/20181209-pytorch1.png"></p>
<div class="highlight"><pre><span></span><span class="c1"># geometric brownian motion (single time step)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">scenarios</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">dW</span> <span class="o">=</span> <span class="n">vol</span> <span class="o">*</span> <span class="n">time</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">scenarios</span><span class="p">,))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">rate</span> <span class="o">-</span> <span class="n">dividend</span> <span class="o">-</span> <span class="n">vol</span><span class="o">*</span><span class="n">vol</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">time</span> <span class="o">+</span> <span class="n">dW</span><span class="p">)</span>

<span class="c1"># put option payoff &amp; discounting</span>
<span class="n">payoff</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">strike</span> <span class="o">-</span> <span class="n">stock</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">scenarios</span><span class="p">,)))</span>
<span class="n">ov</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">payoff</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rate</span><span class="o">*</span><span class="n">time</span><span class="p">)</span>

<span class="c1"># run backpropagation to calculate option greeks</span>
<span class="n">ov</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">grad</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">rate</span><span class="o">.</span><span class="n">grad</span>
<span class="n">vega</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">grad</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">grad</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">dividend</span><span class="o">.</span><span class="n">grad</span>
<span class="n">strike_greek</span> <span class="o">=</span> <span class="n">strike</span><span class="o">.</span><span class="n">grad</span>
</pre></div>


<p>Did you notice that we were able to use automatic differentiation in our stochastic simulation? This means we can potentially develop extremely complex simulation models and use automatic differentiation to understand the effects of every single model input. In this case, our simulation is fairly simple, but the prospects for this technique are exciting! We also see that our results are close to the values from our prior methods.</p>
<div class="highlight"><pre><span></span><span class="n">Option</span> <span class="n">Value</span><span class="p">:</span>     <span class="mf">5.0926</span>   <span class="c1"># sensitivity of option price to:</span>
<span class="o">------------------------</span>   <span class="o">---------------------------------</span>
       <span class="n">Delta</span><span class="p">:</span>    <span class="o">-</span><span class="mf">0.4025</span>   <span class="c1"># underlying price</span>
         <span class="n">Rho</span><span class="p">:</span>   <span class="o">-</span><span class="mf">45.3420</span>   <span class="c1"># interest rates</span>
        <span class="n">Vega</span><span class="p">:</span>    <span class="mf">38.4292</span>   <span class="c1"># volatility</span>
       <span class="n">Theta</span><span class="p">:</span>     <span class="mf">1.8899</span>   <span class="c1"># time</span>
     <span class="n">Epsilon</span><span class="p">:</span>    <span class="mf">40.2495</span>   <span class="c1"># dividend rate</span>
 <span class="n">Strike</span> <span class="n">Sens</span><span class="p">:</span>     <span class="mf">0.4534</span>   <span class="c1"># strike price</span>
</pre></div>


<h5>Results</h5>
<p>Let's look at the results from each of the four methods, focusing on option value, greeks, and run time on my local CPU.</p>
<div class="highlight"><pre><span></span>                     <span class="n">Formula</span>      <span class="n">Numerical</span>      <span class="n">Auto</span><span class="o">-</span><span class="n">Diff</span>    <span class="n">Monte</span> <span class="n">Carlo</span><span class="o">*</span>
<span class="n">Option</span> <span class="n">Value</span><span class="p">:</span>         <span class="mf">5.0885</span>         <span class="mf">5.0885</span>         <span class="mf">5.0885</span>         <span class="mf">5.0926</span>  
<span class="o">-------------------------------------------------------------------------</span>  
       <span class="n">Delta</span><span class="p">:</span>        <span class="o">-</span><span class="mf">0.4026</span>        <span class="o">-</span><span class="mf">0.3907</span>        <span class="o">-</span><span class="mf">0.4026</span>        <span class="o">-</span><span class="mf">0.4025</span>  
         <span class="n">Rho</span><span class="p">:</span>       <span class="o">-</span><span class="mf">45.3458</span>       <span class="o">-</span><span class="mf">45.2968</span>       <span class="o">-</span><span class="mf">45.3458</span>       <span class="o">-</span><span class="mf">45.3420</span>  
        <span class="n">Vega</span><span class="p">:</span>        <span class="mf">38.4103</span>        <span class="mf">38.4164</span>        <span class="mf">38.4103</span>        <span class="mf">38.4292</span>  
       <span class="n">Theta</span><span class="p">:</span>         <span class="mf">1.8883</span>         <span class="mf">1.8803</span>         <span class="mf">1.8883</span>         <span class="mf">1.8899</span>  
     <span class="n">Epsilon</span><span class="p">:</span>        <span class="mf">40.2573</span>        <span class="mf">40.2069</span>        <span class="mf">40.2573</span>        <span class="mf">40.2495</span>  
 <span class="n">Strike</span> <span class="n">Sens</span><span class="p">:</span>         <span class="mf">0.4535</span>         <span class="mf">0.4654</span>         <span class="mf">0.4535</span>         <span class="mf">0.4534</span> 
<span class="o">-------------------------------------------------------------------------</span>
    <span class="n">Run</span> <span class="n">Time</span><span class="p">:</span>       <span class="mf">0.535</span> <span class="n">ms</span>       <span class="mf">1.140</span> <span class="n">ms</span>       <span class="mf">0.489</span> <span class="n">ms</span>       <span class="mf">5.160</span> <span class="n">ms</span>
<span class="o">*</span> <span class="mi">100</span><span class="p">,</span><span class="mo">000</span> <span class="n">scenarios</span>
</pre></div>


<p>The first three methods arrive at the same option price because we used the Black-Scholes formula each time. The first column greeks are the "true" sensitivities with respect to each of the inputs, derived directly from Black-Scholes. We can see that PyTorch automatic differentiation (column 3) was able to exactly reproduce those values in roughly 10% less time! What's more impressive, however, is that automatic differentiation takes less than half the time of the finite difference method.</p>
<p>The derivatives from finite differences (column 2) are slightly different than the "true" values because they are based on 1% jumps from baseline option value. In fact, they capture some of the convexity of the option value. This may or may not be useful depending on how the greeks will be used. For example, if we were hedging a large portfolio of options, then the differences in delta (-0.4026 vs. -0.3907) could impact our hedging accuracy.</p>
<p>Finally, the monte carlo simulation took roughly 10 times longer than the Black-Scholes methods, but that was expected. It likely wasn't necessary to run 100,000 scenarios to converge for a problem like this, so we could shorten run time by reducing that number. Regardless, I'm most impressed with PyTorch's ability to backpropagate derivatives through a stochastic sampler. There are many, many problems that we approach using monte carlo analysis, and I believe automatic differentiation will help us understand the dynamics of those problems much better.</p></p>
        </div>
      </div>
    </div>

  </div>
</div>
    </div>     
    
<footer class="footer text-muted">
  <div class="container">    
    <p>
      Built with <a href="https://blog.getpelican.com/" target="_blank">Pelican</a> and <a href="https://getbootstrap.com/docs/4.0/getting-started/introduction/" target="_blank">Bootstrap</a>.
      <br>
      &copy; 2021 Jason Ash. All rights reserved.
    </p>
  </div>
</footer>	
	<!-- mathjax -->
    <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  
    <!-- optional scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    
  
  </body>
</html>